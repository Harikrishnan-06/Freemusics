<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeStream | Neon Lockscreen Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --neon-green: #39ff14; --neon-cyan: #00f3ff; }
        body { background: #000; color: #fff; font-family: 'Inter', sans-serif; overflow: hidden; }
        
        /* Neon UI Elements */
        .sidebar { background: #000; width: 260px; border-right: 1px solid #1a1a1a; }
        .main-view { background: radial-gradient(circle at top, #0a1f0a 0%, #000 70%); flex: 1; overflow-y: auto; }
        
        .neon-border { border: 1px solid var(--neon-green); box-shadow: 0 0 10px rgba(57, 255, 20, 0.2); }
        .neon-text { color: var(--neon-green); text-shadow: 0 0 10px rgba(57, 255, 20, 0.8); }
        
        .neon-card { background: #0a0a0a; border: 1px solid #1a1a1a; transition: 0.3s; cursor: pointer; border-radius: 12px; }
        .neon-card:hover { border-color: var(--neon-cyan); box-shadow: 0 0 20px rgba(0, 243, 255, 0.3); transform: scale(1.02); }
        
        .playing-now { border-color: var(--neon-green) !important; box-shadow: 0 0 15px var(--neon-green) !important; }
        
        /* Bottom Player */
        .player-bar { height: 100px; background: #000; border-top: 2px solid var(--neon-green); position: fixed; bottom: 0; width: 100%; z-index: 50; }
        #progress { background: linear-gradient(90deg, var(--neon-green), var(--neon-cyan)); box-shadow: 0 0 10px var(--neon-green); }

        /* Small Visible Video - Hidden but exists for mobile audio focus */
        #player-container { position: fixed; top: -1000px; left: -1000px; width: 200px; height: 200px; }
    </style>
</head>
<body class="flex flex-col h-screen">

    <div class="flex flex-1 overflow-hidden">
        <aside class="sidebar p-6 hidden md:flex flex-col gap-8">
            <h1 class="text-2xl font-black neon-text italic tracking-tighter">VIBESTREAM</h1>
            <nav class="space-y-6">
                <button onclick="smartSearch('Latest Tamil Audio 2025')" class="flex items-center gap-4 text-gray-400 hover:neon-text transition w-full text-left">
                    <i class="fa fa-bolt text-neon-green"></i> <span>Tamil Neon</span>
                </button>
                <button onclick="smartSearch('Electronic Phonk 2025')" class="flex items-center gap-4 text-gray-400 hover:neon-text transition w-full text-left">
                    <i class="fa fa-wave-square"></i> <span>Cyber Phonk</span>
                </button>
            </nav>
        </aside>

        <main class="main-view flex flex-col relative">
            <header class="p-6 sticky top-0 z-10 bg-black/80 backdrop-blur-md">
                <div class="relative w-full max-w-lg">
                    <i class="fa fa-search absolute left-4 top-3.5 text-gray-500"></i>
                    <input type="text" id="searchInput" onkeypress="if(event.key==='Enter') smartSearch(this.value)" 
                           placeholder="Search songs..." class="w-full bg-zinc-900 border-2 border-zinc-800 rounded-full py-2 px-12 focus:border-green-500 transition-all text-green-400">
                </div>
            </header>

            <div class="px-8 pb-40">
                <h2 id="listTitle" class="text-5xl font-black mb-8 neon-text uppercase italic">The Flow</h2>
                <div id="results" class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-6"></div>
            </div>
        </main>
    </div>

    <div id="player-container"><div id="player"></div></div>

    <footer class="player-bar px-8 flex items-center justify-between">
        <div class="flex items-center w-1/4">
            <img id="p-art" src="https://via.placeholder.com/60" class="w-14 h-14 rounded border border-green-500 mr-4 object-cover">
            <div class="truncate">
                <div id="p-title" class="font-bold text-sm truncate neon-text">Wait for search</div>
                <div id="p-artist" class="text-[10px] text-zinc-500 truncate">VibeStream Neon</div>
            </div>
        </div>

        <div class="flex flex-col items-center flex-1 max-w-xl px-4">
            <div class="flex items-center gap-10 mb-2">
                <button onclick="changeTrack(-1)" class="text-zinc-400 hover:text-white text-2xl"><i class="fa fa-step-backward"></i></button>
                <button onclick="togglePlay()" id="playBtn" class="w-14 h-14 bg-green-500 text-black rounded-full flex items-center justify-center hover:scale-110 shadow-[0_0_20px_#39ff14]">
                    <i class="fa fa-play text-xl ml-1"></i>
                </button>
                <button onclick="changeTrack(1)" class="text-zinc-400 hover:text-white text-2xl"><i class="fa fa-step-forward"></i></button>
            </div>
            <div class="w-full flex items-center gap-3">
                <span id="time-c" class="text-[10px] text-zinc-500">0:00</span>
                <div class="flex-1 h-1.5 bg-zinc-800 rounded-full overflow-hidden">
                    <div id="progress" class="h-full w-0 transition-all"></div>
                </div>
                <span id="time-t" class="text-[10px] text-zinc-500">0:00</span>
            </div>
        </div>

        <div class="w-1/4 flex justify-end gap-3 items-center">
            <i class="fa fa-volume-high text-green-500"></i>
            <input type="range" oninput="setVol(this.value)" class="w-24 accent-green-500 cursor-pointer h-1">
        </div>
    </footer>

    <script src="https://www.youtube.com/iframe_api"></script>
    <script>
        const YT_API_KEY = 'AIzaSyDLL2PQGEiTJuWnFgm3IQO6TCSxSNHDshU';
        let player, queue = [], currentIndex = 0, isPlaying = false;

        function onYouTubeIframeAPIReady() {
            player = new YT.Player('player', {
                height: '200', width: '200',
                playerVars: { 'autoplay': 1, 'controls': 0, 'playsinline': 1 },
                events: { 'onStateChange': onStateChange }
            });
            setInterval(sync, 500);
        }

        async function smartSearch(q) {
            const res = await fetch(`https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=20&q=${encodeURIComponent(q + ' audio')}&type=video&key=${YT_API_KEY}`);
            const data = await res.json();
            if(data.items) {
                queue = data.items.map(i => ({ id: i.id.videoId, title: i.snippet.title, artist: i.snippet.channelTitle, thumb: i.snippet.thumbnails.high.url }));
                render();
            }
        }

        function render() {
            document.getElementById('results').innerHTML = queue.map((s, i) => `
                <div id="song-${i}" onclick="playTrack(${i})" class="neon-card p-4">
                    <img src="${s.thumb}" class="w-full aspect-square object-cover rounded mb-3">
                    <h4 class="font-bold text-[11px] truncate text-green-400">${s.title}</h4>
                </div>
            `).join('');
        }

        function playTrack(i) {
            currentIndex = i; const s = queue[i];
            player.loadVideoById(s.id);
            document.getElementById('p-title').innerText = s.title;
            document.getElementById('p-artist').innerText = s.artist;
            document.getElementById('p-art').src = s.thumb;
            
            // MOBILE LOCKSCREEN INTEGRATION
            if ('mediaSession' in navigator) {
                navigator.mediaSession.metadata = new MediaMetadata({
                    title: s.title,
                    artist: s.artist,
                    artwork: [{ src: s.thumb, sizes: '512x512', type: 'image/png' }]
                });
                navigator.mediaSession.setActionHandler('play', togglePlay);
                navigator.mediaSession.setActionHandler('pause', togglePlay);
                navigator.mediaSession.setActionHandler('nexttrack', () => changeTrack(1));
                navigator.mediaSession.setActionHandler('previoustrack', () => changeTrack(-1));
            }

            isPlaying = true;
            document.querySelector('#playBtn i').className = "fa fa-pause";
        }

        function onStateChange(e) { if(e.data === 0) changeTrack(1); }
        function togglePlay() {
            if(isPlaying) { player.pauseVideo(); document.querySelector('#playBtn i').className = "fa fa-play ml-1"; }
            else { player.playVideo(); document.querySelector('#playBtn i').className = "fa fa-pause"; }
            isPlaying = !isPlaying;
        }

        function changeTrack(d) { let n = currentIndex + d; if(n >= 0 && n < queue.length) playTrack(n); }
        function sync() {
            if(player && player.getCurrentTime) {
                const c = player.getCurrentTime(), d = player.getDuration();
                if(d > 0) {
                    document.getElementById('progress').style.width = (c/d*100) + "%";
                    document.getElementById('time-c').innerText = fmt(c);
                    document.getElementById('time-t').innerText = fmt(d);
                }
            }
        }
        function fmt(s) { return Math.floor(s/60) + ":" + String(Math.floor(s%60)).padStart(2,'0'); }
        function setVol(v) { player.setVolume(v); }
        window.onload = () => setTimeout(() => smartSearch('Trending Tamil Audio'), 1000);
    </script>
</body>
</html>
